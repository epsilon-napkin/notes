
---
title: 操作系统 Lesson 11
tag: [](/index.md)
---

<style>
table th, 
table td {
  padding: 0.4em;
  border: 1px solid #ccc;
}
</style>

### 资源分配图

- 一个有向图 $G=(V,E)$. 
- 顶点 $V={P_i, R_i}$ 表示资源 $\Box$ 或进程 $\bigcirc$. 
- 箭头表示请求和分配情况. $P_i \to R_i$ 请求, $P_i \gets R_i$ 分配. 

#### 死锁定理

在资源分配图中找⼀个既不阻塞又不孤⽴的进程结点 $P_i$: 系统可分配给它所需的资源, 故它能够继续运⾏直⾄完成, 再释放它所占⽤的资源, 这相当于消去它的请求边和分配边, 使之成为孤⽴结点. 重复上述简化的动作, 若能消去所有的边, 使所有进程都成为孤⽴结点, 则称资源分配图是可以完全简化的; 否则, 就称该资源分配图是不可完全简化的. 

- $S$ 为死锁状态的充分条件是: 当且仅当 $S$ 状态的资源分配图是不可完全简化的. 

### 解除死锁

常采⽤解除死锁的两种⽅法是:
1. 抢占资源. 从⼀个或多个进程中抢占⾜够数量的资源, 分配给死锁进程, 以解除死锁状态. 
1. 终⽌ (或撤消) 进程. 终⽌ (或撤消) 系统中的⼀个或多个死锁进程, 直⾄打破循环环路, 使系统从死锁状态解脱出来. 

### 存储器

| 多级存储器结构 |  |
| - | - |
| CPU 寄存器 | 寄存器 |
| 主存 | 高速缓存, 主存, 磁盘缓存 (`buffer`) |
| 辅存 | 磁盘, 可移动存储介质 |

<br>

| 缓存 | 速度匹配 | 物理 | 
| - | - | - |
| 高速缓存 | CPU $\lrarr$ 主存 | 是 |
| 磁盘缓存 | 主存 $\lrarr$ 磁盘 | 否, 是主存的一部分区域 |

### 程序的装⼊和链接

- 物理地址: 内存由若干存储单元构成, 每个存储单元有个编号, 也称绝对地址. 
- 物理空间: 物理地址的集合, 也称绝对地址空间或存储空间. 
- 逻辑地址: 每个目标程序一般从 `0` 开始编址, 也称相对地址. 
- 逻辑空间: 逻辑地址的集合, 也称相对地址空间或地址空间. 

#### 程序的装⼊

| 装⼊方式 | 装⼊时机 | 地址变化 | 优点 | 缺点 | 环境 |
| - | - | - | - | - | - |
| 绝对装⼊⽅式 | 编程时 | 编译期 | 装⼊简单 | 依赖硬件结构 | 单道程序环境 |  
| 可重定位装⼊⽅式 | 运行前 | 装入前静态重定位 | 不依赖硬件 | 必须有连续空间 | 多道程序环境 |
| 动态运⾏时的装⼊⽅式 | 运行中 | 运行时完成 | 不需要连续空间 | OS 开销大 | 多道程序环境 |

#### 程序的链接

| 链接方式 | 链接时机 | 优点 |
| - | - | - |
| 静态链接 |  事先进⾏链接, 不再拆开 | 稳定 |
| 装⼊时动态链接 | 装⼊内存时, 边装⼊边链接 | 便于修改和更新, 便于实现对⽬标模块的共享 |
| 运⾏时动态链接 |  对某些模块的链接推迟到程序执⾏时才进⾏ | 加快程序的装⼊过程, 节省⼤量的内存空间 | | 
