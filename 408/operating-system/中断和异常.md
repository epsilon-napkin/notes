
---
title: 中断和异常
---

#### 中断的作用

1. 中断会使 CPU 由用户态变为内核态, OS 重新夺回对 CPU 的控制权. (硬件实现)
1. 如果没有中断机制, 就无法进行并发.
1. 中断是操作系统内核夺回 CPU 使用权的唯一途径 (用户态 $\to$ 内核态)

#### 中断的类型

1. 内中断 (异常、例外、陷入)
    1. 与当前执行的指令有关, *中断信号来源于 CPU 内部*, 由某个指令引发的中断.
    1. 陷阱、陷入 [trap]: 由陷入指令引发的, 应用程序故意引发, 如: 系统调用.(陷入指令并非特权指令, 且需要在用户态下执行, 系统调用通过陷入指令完成)
    1. 故障 [fault]: 由错误条件引起, 可能被内核程序修复, CPU 使用权交还给应用程序. 如: 缺页故障.
    1. 终止 [abort]: 由致命错误引起, 内核程序无法修复该错误, 并且不会交还 CPU 使用权, 而是直接终止应用程序. 如: 除法指令除数为 0 (有争议)、非法使用特权指令.

1. 外中断 (也称中断)
    1. 与当前执行的指令无关, *中断信号来源于 CPU 外部*.
    1. 时钟中断: 由时钟部件发来的中断信号, 时钟部件每隔一个时间片, 归给CPU 发送一个时钟中断信号.
    1. I/O 中断: 由输入输出设备发来的中断信号.

*异常会引起中断, 中断未必是异常引起的.* 
