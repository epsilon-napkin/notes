
---
title: 网际协议 IP
---

<style>
img {
  border-radius: 0.2em; 
  width: 400px;
}
hint {
  color: gray;  
}
em {
  color: rgb(201, 152, 244);
  font-style: normal;
}
</style>

[IP 地址的表示](/408/network/dotted-decimal-notation.md#:embed)

与协议 IP 配套使⽤的还有三个协议:
- [地址解析协议 ARP](/408/network/arp.md) [Address Resolution Protocol]. 
- ⽹际控制报⽂协议 ICMP [Internet Control Message Protocol]. 
- ⽹际组管理协议 IGMP [Internet Group Management Protocol]. 

给每个主机 (或路由器) 的接口分配⼀个 IP 地址, 其含义就是这个 IP 地址不但标志了这个主机 (或路由器), ⽽且还标志了此接口所连接的⽹络. 因此, 32 位的 IP 地址采⽤两级结构, 由两个字段组成. 第⼀个字段是 *⽹络号*, 它标志主机 (或路由器) 所连接到的⽹络.⼀个⽹络号在整个互联⽹范围内必须是唯⼀的. 第⼆个字段是 *主机号*, 它标志该主机 (对路由器来说, 就是标志该路由器). ⼀个主机号在所连接的⽹络 (即前⾯的⽹络号所指明的⽹络) 中必须是唯⼀的. 由此可见, ⼀个 IP 地址 *在整个互联⽹范围内是唯⼀的*. 因此, IP 地址可以记为

```
IP := { <⽹络号>, <主机号> }
```

IP 地址中的前 $n$ 位是主机所连接的⽹络号, ⽽ IP 地址中后⾯的 $32-n$ 位是主机号. 

[分类 IP 地址](/408/network/ip-category.md#:embed)

在 20 世纪 90 年代, 当发现 IP 地址在不久后将会枯竭时, ⼀种新的⽆分类编址⽅法 CIDR 就问世了. 这种⽅法虽然也⽆法解决 IP 地址枯竭的问题, 但可以推迟 IP 地址⽤尽的⽇子. 

[⽆分类编址⽅法 CIDR](/408/network/cidr.md#:embed)

在局域⽹中, 由于 MAC 地址已固化在⽹卡上的 ROM 中, 因此常常将 MAC 地址称为硬件地址或物理地址. 从层次的⾓度看, MAC 地址是数据链路层使⽤的地址,⽽IP 地址是⽹络层和以上各层使⽤的地址, 是⼀种逻辑地址.

在发送数据时, 数据从⾼层下到低层, 然后才到通信链路上传输. 使⽤IP 地址的 IP 数据报⼀旦交给数据链路层, 就被封装成 MAC 帧. MAC 帧在传送时使⽤的源地址和⽬的地址都是 MAC 地址, 这两个 MAC 地址都写在 MAC 帧的⾸部中.连接在通信链路上的设备 (主机或路由器) 在收到 MAC 帧时, 根据 MAC 帧⾸部中的MAC 地址决定收下或丢弃. 只有在剥去 MAC 帧的⾸部和尾部后把 MAC 层的数据上交给⽹络层后,⽹络层才能在 IP 数据报的⾸部中找到源 IP 地址和⽬的 IP 地址. 简单来说, 32bit 的 IP 地址确定唯一的主机, 48bit 的 MAC 地址找到唯一的接口. 

总之, IP 地址放在 IP 数据报的⾸部,⽽ MAC 地址则放在 MAC 帧的⾸部. 在⽹络层和⽹络层以上使⽤的是 IP 地址, ⽽数据链路层及以下使⽤的是 MAC 地址. 即 *IP 地址放在网络层的首部, 而硬件地址则放数据链路层的首部.* 当 IP 数据报插⼊到数据链路层的 MAC 帧以后, 整个的 IP 数据报就成为 MAC 帧的数据, 因⽽在数据链路层看不见数据报的 IP 地址.

[IP 数据报的格式](/408/network/ip-datagram.md#:embed)
